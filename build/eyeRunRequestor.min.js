(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.eyeRunRequestor = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
function EyeosAppGateway(e,o){this._innerRequestor=e,this.window=o||window}EyeosAppGateway.closeAppEvent=function(){return"/eyeosapp_closed"},EyeosAppGateway.prototype.isChromeInstalled=function(e){this._innerRequestor.sendRequest("/eyeosapp_is_chrome_installed",null,function(){e(!0)},function(){e(!1)})},EyeosAppGateway.prototype.openApp=function(e){this._innerRequestor.sendRequest("/eyeosapp_open_app/"+encodeURIComponent(e))},EyeosAppGateway.prototype.closeApp=function(){var e=EyeosAppGateway.closeAppEvent(),o=this.window.open(this._innerRequestor.getEyeRunLocation()+e);o.close()},module.exports=EyeosAppGateway;
},{}],2:[function(require,module,exports){
function MacExtensionPopupGateway(e,n,t){this.requestor=e,this.window=n||window,this.mouseChecker=t||new MouseChecker}var MouseChecker=require("./MouseChecker");MacExtensionPopupGateway.focusEvent=function(){return"/windowManager_focus"},MacExtensionPopupGateway.startMouseTrackingEvent=function(){return"/windowManager_startMouseTracking"},MacExtensionPopupGateway.stopMouseTrackingEvent=function(){return"/windowManager_stopMouseTracking"},MacExtensionPopupGateway.addWindowEvent=function(){return"/windowManager_addWindow"},MacExtensionPopupGateway.resetWindowsEvent=function(){return"/windowManager_resetWindows"},MacExtensionPopupGateway.removeWindowEvent=function(){return"/windowManager_removeWindow"},MacExtensionPopupGateway.isWindowVisibleEvent=function(){return"/windowManager_isWindowVisible"},MacExtensionPopupGateway.prototype.focus=function(e){var n=this,t=MacExtensionPopupGateway.focusEvent(),o=function(){var t={x:n.requestor.getImage().width,y:n.requestor.getImage().height};n.mouseChecker.isInsideDocument(t)&&e()};this.requestor.sendRequest(t,null,o)},MacExtensionPopupGateway.prototype.startMouseTracking=function(){var e=MacExtensionPopupGateway.startMouseTrackingEvent();this.requestor.sendRequest(e,null)},MacExtensionPopupGateway.prototype.stopMouseTracking=function(){var e=MacExtensionPopupGateway.stopMouseTrackingEvent(),n=this.window.open(this.requestor.getEyeRunLocation()+e);n.close()},MacExtensionPopupGateway.prototype.resetWindows=function(){this.requestor.sendRequest(MacExtensionPopupGateway.resetWindowsEvent(),null)},MacExtensionPopupGateway.prototype.addWindow=function(e){this.requestor.sendRequest(MacExtensionPopupGateway.addWindowEvent()+"/"+e,null)},MacExtensionPopupGateway.prototype.removeWindow=function(e){this.requestor.sendRequest(MacExtensionPopupGateway.removeWindowEvent()+"/"+e,null)},MacExtensionPopupGateway.prototype.isWindowVisible=function(e,n){this.requestor.sendRequest(MacExtensionPopupGateway.isWindowVisibleEvent()+"/"+e,null,function(){n(!0)},function(){n(!1)})},module.exports=MacExtensionPopupGateway;
},{"./MouseChecker":3}],3:[function(require,module,exports){
function MouseChecker(){}MouseChecker.prototype.isInsideDocument=function(e){return!0},module.exports=MouseChecker;
},{}],4:[function(require,module,exports){
function NullPopupGateway(){}NullPopupGateway.prototype.focus=function(o){o()},NullPopupGateway.prototype.startMouseTracking=function(){},NullPopupGateway.prototype.stopMouseTracking=function(){},NullPopupGateway.prototype.resetWindows=function(){},NullPopupGateway.prototype.addWindow=function(){},NullPopupGateway.prototype.removeWindow=function(){},NullPopupGateway.prototype.isWindowVisible=function(o,t){t(!0)},NullPopupGateway._instance=null,NullPopupGateway.instance=function(){return null==NullPopupGateway._instance&&(NullPopupGateway._instance=new NullPopupGateway),NullPopupGateway._instance},module.exports=NullPopupGateway;
},{}],5:[function(require,module,exports){
function EyeRunRequestor(){this.EYERUN_LOCATION=settings.EYERUN_LOCATION,this._image=new Image}var settings=require("./settings"),MacExtensionPopupGateway=require("./MacExtensionPopupGateway"),NullPopupGateway=require("./NullPopupGateway"),EyeosAppGateway=require("./EyeosAppGateway");EyeRunRequestor.prototype.getImage=function(){return this._image},EyeRunRequestor.prototype._macPopupGateway=function(){return new MacExtensionPopupGateway(this)},EyeRunRequestor.prototype.getEyeRunLocation=function(){return this.EYERUN_LOCATION},EyeRunRequestor.prototype.appGateway=function(){return new EyeosAppGateway(this)},EyeRunRequestor.prototype.popupGateway=function(e){return NullPopupGateway.instance()},EyeRunRequestor.prototype.eyeRunInstalled=function(e){this.sendRequest("",null,function(){e(!0)},function(){e(!1)})},EyeRunRequestor.prototype.renewCard=function(e,t,n){var o={credentials:e};this.sendRequest("/renewCard",o,t,n)},EyeRunRequestor.prototype.setSession=function(e,t,n,o,u){var s={credentials:e,domain:t,transactionId:n};this.sendRequest("/setSession",s,o,u)},EyeRunRequestor.prototype.sendRequest=function(e,t,n,o){var u,s,r,a;t&&(u=t.credentials,s=t.domain,r=t.transactionId,a=u.card,"object"==typeof a&&(a=JSON.stringify(a)));var i=this.EYERUN_LOCATION+e+"/";u&&(i+=encodeURIComponent(a)+"/"+encodeURIComponent(u.signature)),s&&(i+="/"+encodeURIComponent(t.domain)),r&&(i+="/"+encodeURIComponent(r)),this._image.src=i,this._image.onload=n,this._image.onerror=o},module.exports=EyeRunRequestor;
},{"./EyeosAppGateway":1,"./MacExtensionPopupGateway":2,"./NullPopupGateway":4,"./settings":6}],6:[function(require,module,exports){
"use strict";module.exports={EYERUN_LOCATION:"http://localhost:7000"};
},{}]},{},[5])(5)
});